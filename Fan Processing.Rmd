---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(lubridate)
```

```{r eval=FALSE}
# Download the file
raw_buyo = read.csv("C:/Project/buoy.csv", header = T)
head(raw_buyo)
```
Before making summary of the data, data type of certain columns should be transformed to numeric data.

```{r}
# Data type transformation
for (i in 5:ncol(raw_buyo))
    raw_buyo[,i] <- as.numeric(raw_buyo[,i])
```

From the summary, we can see that there is no much variation in column WVHT, DPD, APD, MWD, DEWP, VIS and TIDE, and column PRES and BAR also contains a lot of NA's.

Since those columns cannot provide us with a lot of information, we will drop them for further analysis.

```{r}
buyo <- raw_buyo %>% select(-WVHT, -DPD, -APD, -MWD, -PRES, -DEWP, -VIS, -TIDE, -BAR)
head(buyo)
```


```{r}
summary(buyo)
```
### 2.2.2 Conduct the imputation 
According to the summary above, since "9999","999" and "99" in the dataset provide us with no specific information, we will replace those with NA.
```{r}
for (i in 1:ncol(buyo))
  buyo[,i][which(buyo[,i]==9999|buyo[,i]==999|buyo[,i]==99)] = NA
```

According to the summary above, we will replace NA with median.

```{r}
buyo[is.na(buyo$WD),"WD"] =
  median(buyo$WD,na.rm = T)

buyo[is.na(buyo$WSPD),"WSPD"] =
  median(buyo$WSPD,na.rm = T)

buyo[is.na(buyo$GST),"GST"] =
  median(buyo$GST,na.rm = T)

buyo[is.na(buyo$ATMP),"ATMP"] =
  median(buyo$ATMP,na.rm = T)

buyo[is.na(buyo$WTMP),"WTMP"] =
  median(buyo$WTMP,na.rm = T)
```

Then we will use the summary() to check if NA still existed.
```{r}
# Check the NA
summary(buyo)
```
The summary indicates that no existed NA, the data can be used for further analysis.
## 2.2 Imputation of the dataset

First, we will make histograms to explore the distribution of the columns.

### 2.2.1 Histograms of the columns
```{r}
# Hist. of ATMP
ggplot(data = buyo) + 
  geom_histogram(mapping = aes(x=ATMP),binwidth = 0.5)
```


```{r}
# Hist. of WTMP
ggplot(data = buyo) + 
  geom_histogram(mapping = aes(x=WTMP),binwidth = 0.5)
```

```{r}
# Hist. of WD
ggplot(data = buyo) + 
  geom_histogram(mapping = aes(x=WD),binwidth = 10)
```


```{r}
# Hist. of WSPD
ggplot(data = buyo) + 
  geom_histogram(mapping = aes(x=WSPD),binwidth = 0.5)
```


```{r}
# Hist. of GST
ggplot(data = buyo) + 
  geom_histogram(mapping = aes(x=GST),binwidth = 0.5)
```


## 2.3 Filter the dataset

Make data type transformation on columns for Year, Month, Day and Hour. 
```{r message=FALSE}
for (i in 1:4)
  suppressMessages(
    buyo[,i] <- as.integer(unlist(buyo[,i]))
    )
```

```{r}
buyo$YYYY[which(buyo$YYYY==3899)] = 1999
```


```{r}
buyo <- buyo %>%
  mutate(
    Time = make_datetime(YYYY, MM, DD, hh)
    )
```

```{r}
head(buyo)
```




